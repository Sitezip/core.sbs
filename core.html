<!DOCTYPE html>
<html lang="en" xmlns:>
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-L5VYFB4KHR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-L5VYFB4KHR');
    </script>
    <meta charset="UTF-8" />
    <title>core.js is the way!</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="description" content="" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link rel="icon" href="favicon.png">
</head>
<body style="padding-top: 4rem;">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top shadow p-2">
    <div class="container">
        <!-- Logo -->
        <a class="navbar-brand p-0" href="#">
            <div class="core-pocket" data-core-templates="core" data-core-core-source="core.svg" style="width: 150px;"></div>
        </a>

        <!-- Navbar Links -->
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a href="?" class="nav-link">Home</a></li>
                <li class="nav-item"><a href="#" class="nav-link" target="#main" data-core-templates="other">Change</a></li>
                <li class="nav-item"><a href="#" class="nav-link" target="#main" data-core-templates="stuff">Change Back</a></li>
                <li class="nav-item"><a href="#" class="nav-link" target="#under" data-core-templates="stuff">Add Stuff</a></li>
                <li class="nav-item"><a href="#" class="nav-link" target="#under" data-core-templates="EMPTY">Remove Stuff</a></li>
                <li class="nav-item"><a href="#" class="nav-link" target="#main" data-core-templates="user">Account</a></li>
                <li class="nav-item"><a href="#" class="nav-link" target="#main" data-core-templates="news">Scammer News</a></li>
                <li class="nav-item"><a href="#" class="nav-link" target="core_be_getData" data-core-templates="silent" data-silent-core-source="https://dummyjson.com/products?limit=1">Silent Data</a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container mt-5 mb-5">
    <div class="row">
        <div class="col-8">
            <blockquote>
                <p class="h--dataRef-quote" data-h-data-ref="quote">I said what I said!</p>
            </blockquote>
            <p>—<cite class="h--quote-author">Mother</cite></p>
        </div>
        <div class="col-4">
            <h3 class="mb-0">Login</h3>
            <div class="core-pocket m-0" data-core-templates="default" data-default-core-source="https://zzzap.io/Forms/login"></div>
        </div>
    </div>
</div>

<div class="container">
    <div id="main">
        <div class="core-pocket" data-core-templates="stuff,deep"></div>
    </div>
    <div id="under"></div>
</div>

<div class="container">
    <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
        <div class="col-md-4 d-flex align-items-center">
            <a href="/" class="mb-3 me-2 mb-md-0 text-body-secondary text-decoration-none lh-1">
                <svg class="bi" width="30" height="24"><use xlink:href="#bootstrap"></use></svg>
            </a>
            <span class="mb-3 mb-md-0 text-body-secondary">© 2025 Company, Inc</span>
        </div>

        <ul class="nav col-md-4 justify-content-end list-unstyled d-flex">
            <li class="ms-3"><a class="text-body-secondary" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#twitter"></use></svg></a></li>
            <li class="ms-3"><a class="text-body-secondary" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#instagram"></use></svg></a></li>
            <li class="ms-3"><a class="text-body-secondary" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#facebook"></use></svg></a></li>
        </ul>
    </footer>
</div>

<!-- core-pocket storage elements -->
<section id="cr-data" style="display:none;">
    <template name="other">
        <h1>Hello World!</h1>
        <div>
            <blockquote>
                <p class="h--quote-quote">I said what I said!</p>
            </blockquote>
            <p>—<cite class="h--quote-author">Mother</cite></p>
        </div>
        <div id="header">This will be <strong>good</strong>.</div>
        <a href="#" class="nav-link" target="#main" data-core-templates="deep">recursive</a>
    </template>
    <template name="stuff">
        <table class="table">
            <thead>
            <tr>
                <th>#</th>
                <th>Name</th>
                <th>Height</th>
                <th>Date</th>
                <th>Phone</th>
                <th class="h-pip-name f-upperfirst"></th>
                <th>Hair</th>
                <th>{{data:pip:title:upper}}</th>
            </tr>
            </thead>
            <tbody>
            <tr class="core-clone" data-core-data="users" data-core-source="https://dummyjson.com/users?limit=5">
                <td class="f-padleft" data-f-clue="2|0">{{aug:count}}</td>
                <td>{{rec:firstName:upperfirst}} {{rec:lastName:upperfirst}}</td>
                <td>{{rec:height:decimal:cm}}</td>
                <td>{{rec:birthDate:date:MM/DD/YYYY}}</td>
                <td>{{rec:phone:phone}}</td>
                <td class="f-upper">{{rec:username}}</td>
                <td>{{rec:hair.color}}</td>
                <td>{{data:pip:name:truncate:2}}</td>
            </tr>
            </tbody>
        </table>
        <hr>
        <div class="row">
            <div class="core-clone col-sm-3 mb-2" data-core-data="prods" data-core-source="https://dummyjson.com/products?limit=12">
                <div class="card h-100">
                    <img class="card-img-top" {{rec:thumbnail:core_pk_attr:src}} alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">{{rec:title}}</h5>
                        <p class="card-text">{{rec:description}} - {{aug:count:padleft:5|0}}</p>
                        <p class="card-text">Price: {{rec:price:money:$}} <small class="text-secondary">{{rec:discountPercentage:decimal:%}} off</small> </p>
                        <p class="card-text">
                            Brand: 
                            <strong>
                                <!-- Example: Two ways to reference the record data, via rec and #-->
                                {{rec:brand}} ({{#:sku:lower}})
                            </strong>
                        </p>
                        <p class="card-text">Rating: {{rec:rating:decimal: ⭐}}</p>
                        <p class="card-text">
                            <!-- Example: Two ways to reference the agumented (computed) data, via aug and !-->
                            {{aug:count}}{{!:index}} - 
                            <!-- Example: Two ways to reference the stored data via, data and @ -->
                            {{data:pip:id}} {{@:pip:stuff.vendor:upper}}
                        </p>
                        <p class="card-text">
                            <small>
                                <!-- Example: Manipulate a template value as needed  -->
                                {{aug:value:tags:arg2}}
                                <!-- Example: Manipulate a template cloning string as needed -->
                                {{aug:string:arg1:arg2}}
                            </small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </template>
    <template name="deep">
        <div class="container">
            <h3>Recursive Cloning</h3>
            <div class="row">
                <div class="core-clone col-sm-4" data-core-data="pop">
                    <span class="text-secondary">{{rec:name:upper}}</span> paid {{rec:paid:money:$}} on {{rec:ts:date:date}} for a {{rec:stuff.food}}.
                    <div>{{rec:more:core_pk_cloner:colors}}</div>
                </div>
            </div>
        </div>
    </template>
    <template name="colors">
        <!-- recursively calling itself -->
        {{aug:index}} - <strong>{{rec:color}}</strong><br>
        <div class="bg-light ps-3">{{rec:hues:core_pk_cloner:colors}}</div>
    </template>
    <template name="user">
        <div class="row">
            This is user info, you like?
        </div>
    </template>
    <template name="news">
        <!-- news -->
        <div class="container m-4">
            <h3 class="text-primary">Scammer Highlights</h3>
            <p>Don't be in the news and trust nothing that demands your private information</p>
        </div>

        <div class="container">
            <div class="core-clone col-sm-12 mb-3" data-core-data="news" data-core-source="https://newsdata.io/api/1/news?apikey=pub_499644bc0f473c4fa28fc8e472d99213ee5b3&q=phishing&country=gb,us&language=en&category=crime,education,technology">
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-2 col-sm-12">
                                <a href="{{rec:source_url}}" target="{{rec:source_id}}"><img {{rec:source_icon:core_pk_attr:src}} {{rec:source_id:pk_attr:alt}} class="w-50" onerror="$(this).remove()"></a>
                                <a href="{{rec:link}}" class="btn btn-sm btn-outline-primary mt-3" target="_blank">View</a>
                            </div>
                            <div class="col-lg-10 col-sm-12">
                                <p class="mb-0"><small class="text-muted f-datetime">{{rec:pubDate}}</small></p>
                                <h5 class="card-title text-secondary"><span class="f-padleft" data-f-clue="2|0">{{aug:count}}</span> {{rec:title}}</h5>
                                <p class="card-text f-null-checker f-truncate" data-f-default="..." data-f-clue="200">{{rec:description}}</p>
                                <p class="card-text text-muted">Source: <span>{{rec:source_name}}</span> in <span class="f-upper">{{rec:category.[n]}}</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>
</section>
<script src="core.js"></script>
<script>
    //core.js setup
    //core.ud.defaultDelta = 'n/a';
    core.ud.init = () => {
        //set config
        core.useRouting  = false;
        core.useDebugger = core.hf.getRoute().includes('localhost');
        //set custom cache life
        core.be.cacheExpire = {type:'data',name:'quote',seconds:5}
    }
    //--CUSTOM FUNCTIONS--//

    //callback pre/post UX insertions
    core.ud.prepaint = (dataRef, dataObj, type) => {
        if(core.useDebugger) console.log('ud.prepaint',{dataRef, dataObj, type});
    }

    core.ud.postpaint = (dataRef, dataObj, type) => {
        if(core.useDebugger) console.log('ud.postpaint',{dataRef, dataObj, type});
    }

    //backend pre/post retrieval
    core.ud.preflight = (dataRef, dataSrc, type) => {
        console.log(dataRef,dataSrc);
        let settings = {dataRef:dataRef, dataSrc:dataSrc, type:type};
        if(type.includes('temp')){
            if(dataRef === dataSrc){
                settings.dataSrc = '/html/CORE/' + dataRef + '.html'
            }
        }else if(type === 'data'){
            if(dataRef === 'joke'){
                settings.fetchParams = {mode: "no-cors"};
            }
        }
        if(core.useDebugger) console.log('ud.preflight',{dataRef, dataSrc, type});
        return settings;
    }

    core.ud.postflight = (dataRef, dataObj, type) => {
        if(type === 'data'){
            switch(dataRef){
                case 'prods':
                    dataObj = dataObj.products;
                    break;
                case 'users':
                    dataObj = dataObj.users;
                    break;
                case 'news':
                    let ignoreList   = ['russia','chinese','china','.co.uk','macworld'];
                    let cleanResults = [];
                    if(dataObj.hasOwnProperty('results')){
                        for(const result of dataObj.results){
                            const strResult = JSON.stringify(result).toLowerCase();
                            if(!ignoreList.some(v => strResult.includes(v.toLowerCase()))){
                                cleanResults.push(result);
                            }
                        }
                    }
                    dataObj = cleanResults;
                    break;
            }
        }else{
            //TODO
        }
        if(core.useDebugger) console.log('ud.postflight',{dataRef, dataObj, type});
        return dataObj;
    }

    //Start Of Call
    core.ud.soc = () => {}

    //End Of Call
    core.ud.eoc = () => {}

    //custom cloning augmentation function called with {{aug:value:arg1:arg2}} or {{!:v:arg1:arg2}}
    core.ud.cloneValue = (record, args) => {
        if(core.useDebugger) console.log(record,args);
        return record.tags.join(' | '); // return optional
    }

    //custom cloning augmentation function called with {{aug:string:arg1:arg2}} or {{!:s:arg1:arg2}}
    core.ud.cloneString = (record, args) => {
        if(core.useDebugger) console.log(record,args);
        return args.cloningStr.replace('Price:', (record.discountPercentage > 10 ? 'Sale Price!!!:':'Reg. Price:')); // return optional
    }

    core.ud.getTemplate = (name, newTemplate) => {
        if(core.useDebugger) console.log(name, newTemplate);
        switch(name){
            case 'colors':
                return newTemplate.replace('{{aug:index}}', '{{!:c}}');
        }
        //return newTemplate; // return optional
    }
    //--END CUSTOM FUNCTIONS--//

    //test data
    core.be.getData('quote','https://dummyjson.com/quotes/random/'); //?delay=5000
    core.be.getData('joke','https://dadjokes.developersandbox.xyz/api/v1/random'); //this one fails sucessfully
    core.cr.setData('pip',{name:'fRoDo',title:'LoR',id:33,phone:8881231234,stuff:{vendor:'under20bucks'}});
    core.cr.setData('pop',[
        {name:'fred',paid:21.58,ts:1721788872,phone:8011231233,stuff:{food:'pizza'},more:[{color:'blue'},{color:'gold'}]},
        {name:'jake',paid:2.11,ts:1721188872,phone:8018760408,stuff:{food:'pear'},more:[{color:'red',hues:[{color:'fire engine'},{color:'candy apple'}]}]},
        {name:'jaker',paid:6.87,ts:1721798872,phone:8011231233,stuff:{food:'banana'},more:[{color:'yellow'},{color:'orange'},{color:'pink',hues:[{color:'bright'},{color:'hot'}]},{color:'magenta',hues:[{color:'dark'},{color:'hot'},{color:'magnetic'}]}]}
    ]);
</script>
</body>
</html>